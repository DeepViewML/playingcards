schema: '2.0'
stages:
  train:
    cmd: python -m deepview.modelpack.trainers.detection --config detection.yaml --dvclive
      out/dvclive
    deps:
    - path: dataset
      hash: md5
      md5: 6102dc0a639b44241dcd8fc0be86e221.dir
      size: 332912867
      nfiles: 19
    - path: detection.yaml
      hash: md5
      md5: 1a4adde1f980bf368146cf6b5303a472
      size: 2434
    outs:
    - path: out/chkpts/config.json
      hash: md5
      md5: cc47dea5d4e09d1157ef4344a26227c2
      size: 1542
    - path: out/chkpts/inference_model
      hash: md5
      md5: 5a18f7b461085184f18d50b16f9b9ef5.dir
      size: 25591596
      nfiles: 5
    - path: out/chkpts/inference_model_weights.h5
      hash: md5
      md5: e7c8a0a09da5725860fe2098b8fc6d11
      size: 23722432
    - path: out/chkpts/labels.txt
      hash: md5
      md5: e8d3e10ea4d62e671d825c01cb37f4f3
      size: 65
    - path: out/chkpts/train_model_weights.h5
      hash: md5
      md5: 757c8d7aadd0486286309de2b23d413c
      size: 23724944
  zip:
    cmd: tar czf out/saved_model.tar.gz out/chkpts/inference_model
    outs:
    - path: out/saved_model.tar.gz
      hash: md5
      md5: 6e17af0f789cf1526441ab960a9e2f6b
      size: 22162235
  convert-tensor:
    cmd: python -m deepview.converter --quantize  --quant_normalization unsigned --samples
      dataset/quant-samples  --num_samples 15  --labels out/chkpts/labels.txt --input_type
      uint8  --output_type int8  --default_shape 1,320,320,3  --quant-tensor out/chkpts/inference_model
      out/modelpack-playingcards-320x320-tensor.rtm
    outs:
    - path: out/modelpack-playingcards-320x320-tensor.rtm
      hash: md5
      md5: 6f3b802e3992244729c32c460d3f1f3c
      size: 5942256
  convert-channel:
    cmd: python -m deepview.converter --quantize  --quant_normalization unsigned --samples
      dataset/quant-samples  --num_samples 15  --labels out/chkpts/labels.txt --input_type
      uint8  --output_type int8  --default_shape 1,320,320,3  out/chkpts/inference_model
      out/modelpack-playingcards-320x320-channel.rtm
    outs:
    - path: out/modelpack-playingcards-320x320-channel.rtm
      hash: md5
      md5: ca3d63c8183ead0e69d171c46b295f12
      size: 5993312
