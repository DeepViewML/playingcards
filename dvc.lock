schema: '2.0'
stages:
  train:
    cmd: python -m deepview.modelpack.trainers.detection --config detection.yaml --dvclive
      out/dvclive
    deps:
    - path: dataset
      hash: md5
      md5: 081c963bfb03cff40ab62fc05249e1fb.dir
      size: 332912802
      nfiles: 18
    - path: detection.yaml
      hash: md5
      md5: 0d397f545783c4b289c58ca89aedeaf0
      size: 2375
    outs:
    - path: out/chkpts/config.json
      hash: md5
      md5: 918ad51dc66220cd4628f6c771b2503a
      size: 1540
    - path: out/chkpts/inference_model_weights.h5
      hash: md5
      md5: d0ae5465720dc76674000eadc090e20c
      size: 23722432
    - path: out/chkpts/labels.txt
      hash: md5
      md5: e8d3e10ea4d62e671d825c01cb37f4f3
      size: 65
    - path: out/chkpts/train_model_weights.h5
      hash: md5
      md5: a9a3e59c1e5eb00c2297f1e0d06ad82e
      size: 23724944
  zip:
    cmd: tar czf out/saved_model.tar.gz out/chkpts/inference_model
    outs:
    - path: out/saved_model.tar.gz
      hash: md5
      md5: faad8aea2f7cb8c2b98c9d1202657343
      size: 22110288
  convert-tensor:
    cmd: python -m deepview.converter --quantize  --quant_normalization unsigned --samples
      dataset/quant-samples  --num_samples 15  --labels out/chkpts/labels.txt --input_type
      uint8  --output_type int8  --default_shape 1,320,320,3  --quant-tensor out/chkpts/inference_model
      out/modelpack-playingcards-320x320-tensor.rtm
    outs:
    - path: out/modelpack-playingcards-320x320-tensor.rtm
      hash: md5
      md5: c5583e4faf5b4773816798d0a3e5ca51
      size: 5942256
  convert-channel:
    cmd: python -m deepview.converter --quantize  --quant_normalization unsigned --samples
      dataset/quant-samples  --num_samples 15  --labels out/chkpts/labels.txt --input_type
      uint8  --output_type int8  --default_shape 1,320,320,3  out/chkpts/inference_model
      out/modelpack-playingcards-320x320-channel.rtm
    outs:
    - path: out/modelpack-playingcards-320x320-channel.rtm
      hash: md5
      md5: bab7d726126d335c70038b0c30baef91
      size: 5993312
